!-------------------------------------------------------------------------------
MODULE MathFunction
!-------------------------------------------------------------------------------
use globals

implicit none
public

CONTAINS
!-------------------------------------------------------------------------------
function v_size(v)
!-------------------------------------------------------------------------------
real(dp) :: v_size
real(dp), intent(in) :: v(:)

v_size = dsqrt(dot_product(v,v))

end function v_size
!-------------------------------------------------------------------------------
function v_norm(v)
!-------------------------------------------------------------------------------
real(dp), intent(in) :: v(:)
real(dp), dimension(size(v)) :: v_norm

v_norm = v / v_size(v)

end function v_norm
!-------------------------------------------------------------------------------
function cross(u,v)
!-------------------------------------------------------------------------------
real(dp) :: cross(3)
real(dp), intent(in) :: u(3), v(3)

cross(1) = u(2)*v(3) - u(3)*v(2)
cross(2) = u(3)*v(1) - u(1)*v(3)
cross(3) = u(1)*v(2) - u(2)*v(1)

end function cross
!-------------------------------------------------------------------------------
!-------------------------------------------------------------------------------
!-------------------------------------------------------------------------------
!-------------------------------------------------------------------------------
!-------------------------------------------------------------------------------
!-------------------------------------------------------------------------------
!-------------------------------------------------------------------------------
END MODULE MathFunction
!-------------------------------------------------------------------------------
